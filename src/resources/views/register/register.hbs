<script>
    function hasWhiteSpace(s) {
        return (/\s/).test(s);
    }

    function formValid() {
        f = document.formRegister
        var validname = /^[A-Za-z]+|(\s)$/;
        var format = /[!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?]+/;
        var phone_pattern = /^(\(0\d{1,3}\)\d{7})|(0\d{9})$/;
        var email_pattern = /^[a-zA-Z]\w*(\.\w+)*\@\w+(\.\w{2,3})+$/;

        // Username validation
        if (format.test(f.username.value) || hasWhiteSpace(f.username.value)) {
            alert("Invalid Username, please enter again");
            f.username.focus();
            return false;
        }
        // Password validation
        if (f.password.value != f.confirm.value) {
            alert("Password and Confirm Pass do not match, please enter again");
            f.confirm.focus();
            return false;
        }
        // Firstname and Lastname validation
        if (format.test(f.firstname.value) || validname.test(f.firstname.value) == false) {
            alert("Invalid first name. Please enter again");
            f.firstname.focus();
            return false;
        }
        if (format.test(f.lastname.value) || validname.test(f.lastname.value) == false) {
            alert("Invalid last name. Please enter again");
            f.lastname.focus();
            return false;
        }
        // Telephone validation
        if (phone_pattern.test(f.telephone.value) == false) {
            alert("Invalid phone number, please enter again");
            f.txtTelephone.focus();
            return false;
        }
        return true;
    }
</script>

<section class="d-flex justify-content-center align-items-center">
    <div class="row mx-0">
        <div class="col-lg-6 d-none d-lg-block" style="margin-top: 10rem">
            <img src="/img/Signup.jpg" width="100%">
        </div>
        <div class="col-lg-6" style="background-color: #f3f3f3;">
            <form id="formRegister" name="formRegister" method="POST" action="/register/auth"
                class="card-body p-md-5 text-black" onsubmit="return formValid()">
                <h3 class="mb-5 text-uppercase" align="center">
                    <strong>Customer registration</strong>
                </h3>
                {{#if success }}
                <div class="alert alert-success text-center my-1">{{ success }}</div>
                {{/if}}
                {{#if error }}
                <div class="alert alert-danger text-center">{{ error }}</div>
                {{/if}}
                <div class="form-group">
                    <label class="font-weight-bold" for="txtUsername">Username</label>
                    {{#if username }}
                    <input type="text" id="txtUsername" class="form-control" name="username" value="{{ username }}"
                        required>
                    {{else}}
                    <input type="text" id="txtUsername" class="form-control" name="username" required>
                    {{/if}}
                </div>

                <div class="form-group">
                    <label for="Password" class="font-weight-bold">Password</label>
                    <input type="password" class="form-control" id="Password" name="password" minlength="5" required>
                </div>

                <div class="form-group">
                    <label class="font-weight-bold" for="txtConfirmPass">Confirm</label>
                    <input type="password" id="txtConfirmPass" class="form-control" name="confirm" minlength="5"
                        required>
                </div>

                <div class="row">
                    <div class="col-md-6 mb-0">
                        <div class="form-group">
                            <label class="font-weight-bold" for="txtFirstname">First Name</label>
                            {{#if firstname }}
                            <input type="text" id="txtFirstname" class="form-control" name="firstname"
                                value="{{ firstname }}" required>
                            {{else}}
                            <input type="text" id="txtFirstname" class="form-control" name="firstname" required>
                            {{/if}}
                        </div>
                    </div>
                    <div class="col-md-6 mb-0">
                        <div class="form-group">
                            <label class="font-weight-bold" for="txtLastname">Last Name</label>
                            {{#if lastname }}
                            <input type="text" id="txtLastname" class="form-control" name="lastname"
                                value="{{ lastname }}" required>
                            {{else}}
                            <input type="text" id="txtLastname" class="form-control" name="lastname" required>
                            {{/if}}
                        </div>
                    </div>
                </div>

                <div class="d-md-flex justify-content-start align-items-center mb-3">
                    <h6 class="font-weight-bold mb-3 mb-lg-0 mr-5">Gender:</h6>

                    <div class="form-check form-check-inline mb-0 mr-5">
                        <input class="form-check-input" type="radio" name="gender" id="MaleGender" value="true"
                            required>
                        <label class="form-check-label" for="MaleGender">Male</label>
                    </div>

                    <div class="form-check form-check-inline mb-0 ml-5">
                        <input class="form-check-input" type="radio" name="gender" id="FemaleGender" value="false"
                            required>
                        <label class="form-check-label" for="FemaleGender">Female</label>
                    </div>
                </div>

                <div class="form-group">
                    <label class="font-weight-bold" for="txtBirthday">Birthdate</label>
                    {{#if birthdate }}
                    <input type="date" id="txtBirthday" name="birthdate" class="form-control" value="{{ birthdate }}"
                        required>
                    {{else}}
                    <input type="date" id="txtBirthday" name="birthdate" class="form-control" required>
                    {{/if}}
                </div>

                <div class="form-group">
                    <label class="font-weight-bold" for="txtTelephone">Telephone</label>
                    {{#if telephone }}
                    <input type="text" id="txtTelephone" class="form-control" name="telephone" value="{{ telephone }}"
                        required>
                    {{else}}
                    <input type="text" id="txtTelephone" class="form-control" name="telephone" required>
                    {{/if}}
                </div>

                <div class="form-group">
                    <label for="Email" class="font-weight-bold">Email</label>
                    {{#if email }}
                    <input type="email" class="form-control" name="email" id="Email" aria-describedby="emailHelp"
                        value="{{ email }}" required>
                    {{else}}
                    <input type="email" class="form-control" name="email" id="Email" aria-describedby="emailHelp"
                        required>
                    {{/if}}
                </div>

                <div class="form-group">
                    <label class="font-weight-bold" for="txtAddress">Address</label>
                    {{#if address }}
                    <input type="text" id="txtAddress" class="form-control" name="address" value="{{ address }}"
                        required>
                    {{else}}
                    <input type="text" id="txtAddress" class="form-control" name="address" required>
                    {{/if}}
                </div>

                <div class="d-flex justify-content-end pt-2">
                    <button type="submit" class="btn btn-dark" style="width: 100%" name="btnSignup">
                        Sign up
                    </button>
                </div>
            </form>
        </div>
    </div>
    {{#if status}}
    <input type="hidden" id="notice" value="{{ status }}">
    {{/if}}
    <script>
        const status = document.getElementById("notice").value
        alert("Register " + status + "!")
        window.location = '/login'
    </script>
</section>